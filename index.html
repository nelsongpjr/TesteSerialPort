<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

    </head>

    <body>
        <div>
            <div>
                <label for="filePicker">Choose or drag a file:</label>
                <br>
                <input type="file" multiple id="filePicker">
            </div>
            <br>
            <div>
                <button type="submit" name="enviar" onclick="encode()"> Enviar</button>
                <h1>Base64 encoded version</h1>
                <textarea id="base64textarea" placeholder="Base64 will appear here" cols="50" rows="15"></textarea>
            </div>
        </div>
        <script src="main.js"></script>


        <script>
                    var fs = require('fs');


                    var handleFileSelect = function (evt) {
                        var files = evt.target.files;
                        var file = files[0];

                        console.log(files);
                        if (files && file) {
                            var reader = new FileReader();
                            var binaryString;
                            reader.onload = function (readerEvt) {
                                binaryString = readerEvt.target.result;
                                //console.log(encoded);
                                //console.log(decoded);

                                document.getElementById("base64textarea").value = btoa(binaryString);
                            };

                            var encoded = encode64(binaryString);
                            var decoded = decode64(encoded);

                            reader.readAsDataUrl(binaryString);
                        }
                    };




                    /*function encode64(input) {
                     
                     input = escape(input);
                     
                     var output = "";
                     
                     var chr1, chr2, chr3 = "";
                     
                     var enc1, enc2, enc3, enc4 = "";
                     
                     var i = 0;
                     
                     
                     
                     do {
                     
                     chr1 = input.charCodeAt(i++);
                     
                     chr2 = input.charCodeAt(i++);
                     
                     chr3 = input.charCodeAt(i++);
                     
                     
                     
                     enc1 = chr1 >> 2;
                     
                     enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                     
                     enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                     
                     enc4 = chr3 & 63;
                     
                     
                     
                     if (isNaN(chr2)) {
                     
                     enc3 = enc4 = 64;
                     
                     } else if (isNaN(chr3)) {
                     
                     enc4 = 64;
                     
                     }
                     
                     
                     
                     output = output +
                     keyStr.charAt(enc1) +
                     keyStr.charAt(enc2) +
                     keyStr.charAt(enc3) +
                     keyStr.charAt(enc4);
                     
                     chr1 = chr2 = chr3 = "";
                     
                     enc1 = enc2 = enc3 = enc4 = "";
                     
                     } while (i < input.length);
                     
                     
                     
                     return output;
                     
                     }
                     
                     
                     
                     function decode64(input) {
                     
                     var output = "";
                     
                     var chr1, chr2, chr3 = "";
                     
                     var enc1, enc2, enc3, enc4 = "";
                     
                     var i = 0;
                     
                     
                     
                     // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
                     
                     var base64test = /[^A-Za-z0-9\+\/\=]/g;
                     
                     if (base64test.exec(input)) {
                     
                     alert("There were invalid base64 characters in the input text.\n" +
                     "Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\n" +
                     "Expect errors in decoding.");
                     
                     }
                     
                     input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");
                     
                     
                     
                     do {
                     
                     enc1 = keyStr.indexOf(input.charAt(i++));
                     
                     enc2 = keyStr.indexOf(input.charAt(i++));
                     
                     enc3 = keyStr.indexOf(input.charAt(i++));
                     
                     enc4 = keyStr.indexOf(input.charAt(i++));
                     
                     
                     
                     chr1 = (enc1 << 2) | (enc2 >> 4);
                     
                     chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
                     
                     chr3 = ((enc3 & 3) << 6) | enc4;
                     
                     
                     
                     output = output + String.fromCharCode(chr1);
                     
                     
                     
                     if (enc3 != 64) {
                     
                     output = output + String.fromCharCode(chr2);
                     
                     }
                     
                     if (enc4 != 64) {
                     
                     output = output + String.fromCharCode(chr3);
                     
                     }
                     
                     
                     
                     chr1 = chr2 = chr3 = "";
                     
                     enc1 = enc2 = enc3 = enc4 = "";
                     
                     
                     
                     } while (i < input.length);
                     
                     
                     
                     return unescape(output);
                     
                     }
                     
                     */
                    if (window.File && window.FileReader && window.FileList && window.Blob) {
                        document.getElementById('filePicker').addEventListener('change', handleFileSelect, false);
                    } else {
                        alert('The File APIs are not fully supported in this browser.');
                    }
        </script>

    </body>
</html>
